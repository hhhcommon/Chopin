<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<script src="./resources/plugins/hplus/js/jquery-2.1.1.min.js"></script>
</head>
<body>
	<div class="form-group">
		<label class="col-sm-3 control-label">测试图片：</label>
		<div class="col-sm-8">
			<div class="previewImg">
				<img class="defaultImg" src="https://ss0.bdstatic.com/5aV1bjqh_Q23odCf/static/superman/img/logo_top_ca79a146.png"
					alt="front cover" />
			</div>
			<input id="uploadImg" name="uploadImg" class="form-control"
				type="file" accept=".png,.jpg" /> <input id="ContentImg"
				name="ContentImg" type="hidden" value="" /> <span
				class="help-block m-b-none"><i class="fa fa-info-circle"></i>文件最大1M，支持JPG、PNG格式</span>
		</div>
	</div>
	<script type="text/javascript">
         $(function(){
        	 $('#uploadImg').change(function(){
              var _this=$(this);
        		//文件上传
        	     var oMyForm = new FormData();
        	     oMyForm.append("ContentFile", $(this)[0].files[0]);
        	     $.ajax({
        	        url:"http://182.92.175.134:1108/Chopin/common/uploadCM.do",
        	        type:"POST",
        	        data:oMyForm,
        	        cache: false,
        	        processData: false,
        	        contentType: false,
        	        dataType:"json",
        	        //表单提交前进行验证
        	        success: function (opeResult){
        	          if(opeResult.jsonType=="1"){
        	            //alert("上传成功");
        	            alert(opeResult);
//         	             _this.siblings("input[type='hidden']").val(opeResult.data[0].storeFilename);
        	          }else{
        	             alert(opeResult.err);
        	          }
        	        },
        	        error: function(jqXHR){
        	          alert("发生错误" + jqXHR.status);
        	        }
        	    });
        	 });
         });
     </script>
</body>
</html>